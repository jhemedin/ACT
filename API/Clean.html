

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>act.io.clean.CleanDataset &mdash; Atmospheric Community Toolkit 0.post236+g7213636 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script type="text/javascript" src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="act.plotting (act.plotting)" href="plotting.html" />
    <link rel="prev" title="act.io.csvfiles.read_csv" href="generated/act.io.csvfiles.read_csv.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Atmospheric Community Toolkit
          

          
          </a>

          
            
            
              <div class="version">
                0.post236+g7213636
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CREATING_ENVIRONMENTS.html">Setting up an Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/auto_examples/index.html">ACT Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html">Release History</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="corrections.html">act.corrections (act.corrections)</a></li>
<li class="toctree-l2"><a class="reference internal" href="discovery.html">act.discovery (act.discovery)</a></li>
<li class="toctree-l2"><a class="reference internal" href="io.html">act.io (act.io)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">act.io.clean.CleanDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">act.plotting (act.plotting)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Display.html">act.plotting.Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="TimeSeriesDisplay.html">act.plotting.TimeSeriesDisplay</a></li>
<li class="toctree-l2"><a class="reference internal" href="WindRoseDisplay.html">act.plotting.WindRoseDisplay</a></li>
<li class="toctree-l2"><a class="reference internal" href="SkewTDisplay.html">act.plotting.SkewTDisplay</a></li>
<li class="toctree-l2"><a class="reference internal" href="XSectionDisplay.html">act.plotting.XSectionDisplay</a></li>
<li class="toctree-l2"><a class="reference internal" href="HistogramDisplay.html">act.plotting.HistogramDisplay</a></li>
<li class="toctree-l2"><a class="reference internal" href="retrievals.html">act.retrievals (act.retrievals)</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">act.utils (act.utils)</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Atmospheric Community Toolkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">API Reference</a> &raquo;</li>
        
          <li><a href="io.html">act.io (act.io)</a> &raquo;</li>
        
      <li>act.io.clean.CleanDataset</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/API/Clean.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="act-io-clean-cleandataset">
<h1>act.io.clean.CleanDataset<a class="headerlink" href="#act-io-clean-cleandataset" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="act.io.clean.CleanDataset">
<em class="property">class </em><code class="sig-prename descclassname">act.io.clean.</code><code class="sig-name descname">CleanDataset</code><span class="sig-paren">(</span><em class="sig-param">xarray_obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/act/io/clean.html#CleanDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#act.io.clean.CleanDataset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="act.io.clean.CleanDataset.clean_arm_qc">
<code class="sig-name descname">clean_arm_qc</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">override_cf_flag=True</em>, <em class="sig-param">clean_units_string=True</em>, <em class="sig-param">correct_valid_min_max=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/act/io/clean.html#CleanDataset.clean_arm_qc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#act.io.clean.CleanDataset.clean_arm_qc" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to clean up xarray object QC variables.</p>
<p>…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>override_cf_flag</strong><span class="classifier">bool</span></dt><dd><p>Option to overwrite CF flag_masks, flag_meanings, flag_values
if exists.</p>
</dd>
<dt><strong>clean_units_string</strong><span class="classifier">bool</span></dt><dd><p>Option to clean up units string from ‘unitless’
to udunits compliant ‘1’.</p>
</dd>
<dt><strong>correct_valid_min_max</strong><span class="classifier">bool</span></dt><dd><p>Option to correct use of valid_min and valid_max with QC variables
by moving from data variable to QC varible, renaming to fail_min,
fail_max and fail_detla if the valid_min, valid_max or valid_delta
is listed in bit discription attribute. If not listed as
used with QC will assume is being used correctly.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="act.io.clean.CleanDataset.clean_arm_state_variables">
<code class="sig-name descname">clean_arm_state_variables</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">variables</em>, <em class="sig-param">override_cf_flag=True</em>, <em class="sig-param">clean_units_string=True</em>, <em class="sig-param">integer_flag=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/act/io/clean.html#CleanDataset.clean_arm_state_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#act.io.clean.CleanDataset.clean_arm_state_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to clean up state variables to use more CF style.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>variables</strong><span class="classifier">str or list of str</span></dt><dd><p>List of variable names to update.</p>
</dd>
<dt><strong>override_cf_flag</strong><span class="classifier">bool</span></dt><dd><p>Option to overwrite CF flag_meanings attribute if it exists
with the values from ARM QC bit_#_description.</p>
</dd>
<dt><strong>clean_units_string</strong><span class="classifier">bool</span></dt><dd><p>Option to update units string if set to ‘unitless’ to be
udunits compliant ‘1’.</p>
</dd>
<dt><strong>integer_flag</strong><span class="classifier">bool</span></dt><dd><p>Passthrogh keyword of ‘flag’ for get_attr_info()</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="act.io.clean.CleanDataset.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">cleanup_arm_qc=True</em>, <em class="sig-param">clean_arm_state_vars=None</em>, <em class="sig-param">handle_missing_value=True</em>, <em class="sig-param">link_qc_variables=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/act/io/clean.html#CleanDataset.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#act.io.clean.CleanDataset.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper method to automatically call all the standard methods
for obj cleanup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cleanup_arm_qc</strong><span class="classifier">bool</span></dt><dd><p>Option to clean xarray object from ARM QC to CF QC standards
Default is True</p>
</dd>
<dt><strong>clean_arm_state_vars</strong><span class="classifier">list of str</span></dt><dd><p>Option to clean xarray object state variables from ARM to CF
standards. Pass in list of variable names.</p>
</dd>
<dt><strong>handle_missing_value</strong><span class="classifier">bool</span></dt><dd><p>Go through variables and look for cases where a QC or state varible
was convereted to a float and missing values set to np.nan. This
is done because of xarry’s default to use mask_and_scale=True.
This will convert the data type back to integer and replace
any instances of np.nan to a missing value indicator (most
likely -9999).</p>
</dd>
<dt><strong>link_qc_variables</strong><span class="classifier">bool</span></dt><dd><p>Option to link QC variablers through ancillary_variables if not
already set.</p>
</dd>
<dt><strong>**kwargs:</strong></dt><dd><p>Keyword arguments passed through to clean.clean_arm_qc
method.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="act.io.clean.CleanDataset.correct_valid_minmax">
<code class="sig-name descname">correct_valid_minmax</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">qc_variable</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/act/io/clean.html#CleanDataset.correct_valid_minmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#act.io.clean.CleanDataset.correct_valid_minmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to correct the name and location of
quality control limit variables that use
valid_min and valid_max incorrectly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>qc_varialbe: str</strong></dt><dd><p>Name of quality control variable in xarray object to correct.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="act.io.clean.CleanDataset.get_attr_info">
<code class="sig-name descname">get_attr_info</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">variable=None</em>, <em class="sig-param">flag=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/act/io/clean.html#CleanDataset.get_attr_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#act.io.clean.CleanDataset.get_attr_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get ARM quality control definitions from the ARM standard
bit_#_description, … attributes and return as dictionary.
Will attempt to guess if the flag is integer or bit packed
based on what attributes are set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>variable</strong><span class="classifier">str</span></dt><dd><p>Variable name to get attribute information. If set to None
will get global attributes.</p>
</dd>
<dt><strong>flag</strong><span class="classifier">bool</span></dt><dd><p>Optional flag indicating if QC is expected to be bitpacked
or integer. Flag = True indicates integer QC. Default
is bitpacked or False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>attributes dictionary</strong><span class="classifier">dict or None</span></dt><dd><p>A dictionary contianing the attribute information converted from
ARM QC to CF QC. All keys include ‘flag_meanings’, ‘flag_masks’,
‘flag_values’, ‘flag_assessments’, ‘flag_tests’, ‘arm_attributes’.
Returns None if none found.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="act.io.clean.CleanDataset.handle_missing_values">
<code class="sig-name descname">handle_missing_values</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">default_missing_value=-9999</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/act/io/clean.html#CleanDataset.handle_missing_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#act.io.clean.CleanDataset.handle_missing_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Correctly handle missing_value and _FillValue in object.
xarray will automatically replace missing_value and
_FillValue in the data with NaN. This is great for data set
as type float but not great for int data. Can cause issues
with QC and state fields. This will loop through the array
looking for state and QC fields and revert them back to int
data type if upconverted to float to handle NaNs. Issue is that
xarray will convert data type to float if the attribute is defined
even if no data are set as missing value. xarray will also then
remove the missing_value or _FillValue variable attribute. This
will put the missing_value attribute back if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>default_missing_value: numpy int or float</strong></dt><dd><p>The default missing value to use if a missing_value attribute
is not defined but one is needed.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="act.io.clean.CleanDataset.link_variables">
<code class="sig-name descname">link_variables</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/act/io/clean.html#CleanDataset.link_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#act.io.clean.CleanDataset.link_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Add some attributes to link and explain data
to QC data relationship. Will use non-CF standard_name
of quality_flag. Hopefully this will be added to the
standard_name table in the future.</p>
</dd></dl>

<dl class="method">
<dt id="act.io.clean.CleanDataset.matched_qc_variables">
<em class="property">property </em><code class="sig-name descname">matched_qc_variables</code><a class="headerlink" href="#act.io.clean.CleanDataset.matched_qc_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Find variables that are QC variables and return list of names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>variables: list of str</dt><dd><p>A list of strings containing the name of each variable.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plotting.html" class="btn btn-neutral float-right" title="act.plotting (act.plotting)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="generated/act.io.csvfiles.read_csv.html" class="btn btn-neutral float-left" title="act.io.csvfiles.read_csv" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Adam Theisen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>